<div class="clients-page">
  <div class="page-header">
    <div class="page-title-section">
      <h1 class="page-title">Listado de Clientes Finales</h1>
      <p class="page-subtitle">Gestiona y visualiza la informaci√≥n centralizada de tus clientes corporativos.</p>
    </div>
    <button (click)="openNewClientModal()" class="btn btn-primary">
      <app-hero-icon name="user-plus" [size]="18"></app-hero-icon>
      Nuevo Cliente
    </button>
  </div>

  <app-clients-toolbar
    [showPendingToggle]="isCompanyUser()"
    [pendingActive]="showPending()"
    [pendingCount]="pendingCount()"
    (pendingToggle)="togglePending()"
  ></app-clients-toolbar>

  @if (loading() || error() || clients().length === 0) {
    <app-clients-table
      [loading]="loading()"
      [error]="error()"
      [clients]="clients()"
      [emptyTitle]="showPending() ? 'No hay clientes pendientes' : 'No hay clientes registrados'"
      [emptyDescription]="showPending() ? 'No hay solicitudes pendientes de match.' : 'Comienza agregando tu primer cliente al sistema'"
      [emptyActionLabel]="showPending() ? undefined : 'Crear Primer Cliente'"
      (createRequested)="openNewClientModal()"
      (edit)="openEditClientModal($event)"
      (remove)="deleteClient($event)"
    ></app-clients-table>
  } @else {
    <app-clients-table
      [clients]="clients()"
      [emptyTitle]="showPending() ? 'No hay clientes pendientes' : 'No hay clientes registrados'"
      [emptyDescription]="showPending() ? 'No hay solicitudes pendientes de match.' : 'Comienza agregando tu primer cliente al sistema'"
      [emptyActionLabel]="showPending() ? undefined : 'Crear Primer Cliente'"
      (edit)="openEditClientModal($event)"
      (remove)="deleteClient($event)"
    ></app-clients-table>

    @if (!showPending()) {
    <app-clients-pagination
      [currentCount]="clients().length"
      [totalCount]="totalCount()"
      [hasPrevious]="hasPrevious()"
      [hasNext]="hasNext()"
      (previous)="previousPage()"
      (next)="nextPage()"
    ></app-clients-pagination>

    <app-clients-stats
      [totalCount]="totalCount()"
      [currentCount]="clients().length"
    ></app-clients-stats>
    }
  }

  <!-- Modal Flotante -->
  @if (showModal()) {
    <app-clients-form-modal
      [clientForm]="clientForm"
      [isEditMode]="isEditMode()"
      [formLoading]="formLoading()"
      [formError]="formError()"
      (close)="closeModal()"
      (submit)="onSubmit($event)"
    ></app-clients-form-modal>
  }

  @if (showSuccessModal()) {
    <app-clients-success-modal
      (close)="closeSuccessModal()"
    ></app-clients-success-modal>
  }
</div>
