<app-modal
  [title]="isEditMode ? 'Editar Empresa' : 'Nueva Empresa'"
  size="lg"
  (close)="close.emit()"
>
  <form [formGroup]="companyForm" (ngSubmit)="submit.emit($event)" class="modal-form">
      @if (formError) {
        <div class="form-error-message">
          <app-hero-icon name="exclamation-circle" [size]="20"></app-hero-icon>
          <span>{{ formError }}</span>
        </div>
      }

      <div class="form-section">
        <h3 class="section-title">Información Básica</h3>
        
        <div class="form-group">
          <label for="company_name">
            Nombre de Empresa <span class="required">*</span>
          </label>
          <input
            type="text"
            id="company_name"
            formControlName="company_name"
            placeholder="Ingrese el nombre de la empresa"
            [class.invalid]="companyForm.get('company_name')?.invalid && companyForm.get('company_name')?.touched"
          />
          @if (companyForm.get('company_name')?.invalid && companyForm.get('company_name')?.touched) {
            <span class="error-text">{{ getFieldError('company_name') }}</span>
          }
        </div>

        <div class="form-group">
          <label for="ruc">
            RUC <span class="required">*</span>
          </label>
          <input
            type="text"
            id="ruc"
            formControlName="ruc"
            placeholder="Ingrese el RUC"
            [class.invalid]="companyForm.get('ruc')?.invalid && companyForm.get('ruc')?.touched"
          />
          @if (companyForm.get('ruc')?.invalid && companyForm.get('ruc')?.touched) {
            <span class="error-text">{{ getFieldError('ruc') }}</span>
          }
        </div>

        <div class="form-group">
          <label for="email">
            Email <span class="required">*</span>
          </label>
          <input
            type="email"
            id="email"
            formControlName="email"
            placeholder="correo@ejemplo.com"
            [class.invalid]="companyForm.get('email')?.invalid && companyForm.get('email')?.touched"
          />
          @if (companyForm.get('email')?.invalid && companyForm.get('email')?.touched) {
            <span class="error-text">{{ getFieldError('email') }}</span>
          }
        </div>

        <div class="form-group">
          <label for="description">
            Descripción
          </label>
          <textarea
            id="description"
            formControlName="description"
            placeholder="Ingrese una descripción de la empresa"
            rows="3"
          ></textarea>
        </div>

        <div class="form-group">
          <label for="password">
            Contraseña 
            @if (!isEditMode) {
              <span class="required">*</span>
            } @else {
              <span class="optional">(opcional - dejar en blanco para no cambiar)</span>
            }
          </label>
          <input
            type="password"
            id="password"
            formControlName="password"
            [placeholder]="isEditMode ? 'Dejar en blanco para no cambiar' : 'Ingrese la contraseña'"
            [class.invalid]="companyForm.get('password')?.invalid && companyForm.get('password')?.touched"
          />
          @if (companyForm.get('password')?.invalid && companyForm.get('password')?.touched) {
            <span class="error-text">{{ getFieldError('password') }}</span>
          }
        </div>
      </div>

      <div class="modal-actions">
        <button type="button" class="btn btn-secondary" (click)="close.emit()" [disabled]="formLoading">
          Cancelar
        </button>
        <button type="submit" class="btn btn-primary" [disabled]="companyForm.invalid || formLoading">
          {{ isEditMode ? 'Guardar Cambios' : 'Crear Empresa' }}
        </button>
      </div>
    </form>
</app-modal>
